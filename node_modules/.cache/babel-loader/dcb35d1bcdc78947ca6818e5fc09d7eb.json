{"ast":null,"code":"import attachGeocoding from \"src/decidim/geocoding/attach_input\";\nimport getCoordinateInputName from \"src/decidim/geocoding/coordinate_input\";\n$(function () {\n  var $checkbox = $(\"input:checkbox[name$='[has_address]']\");\n  var $addressInput = $(\"#address_input\");\n  var $addressInputField = $(\"input\", $addressInput);\n  var $map = $(\"#address_map\");\n  var latFieldName = \"latitude\";\n  var longFieldName = \"longitude\";\n\n  if ($addressInputField.length > 0) {\n    latFieldName = getCoordinateInputName(\"latitude\", $addressInputField, {});\n    longFieldName = getCoordinateInputName(\"longitude\", $addressInputField, {});\n  }\n\n  $map.hide();\n\n  if ($checkbox.length > 0) {\n    var toggleInput = function toggleInput() {\n      if ($checkbox[0].checked) {\n        $addressInput.show();\n        $addressInputField.prop(\"disabled\", false);\n      } else {\n        $addressInput.hide();\n        $addressInputField.prop(\"disabled\", true);\n      }\n    };\n\n    toggleInput();\n    $checkbox.on(\"change\", toggleInput);\n  }\n\n  if ($addressInput.length > 0) {\n    if ($checkbox[0].checked) {\n      $map.show();\n    }\n\n    var ctrl = $(\"[data-decidim-map]\").data(\"map-controller\");\n    ctrl.setEventHandler(\"coordinates\", function (ev) {\n      $(\"input[name='\".concat(latFieldName, \"']\")).val(ev.lat);\n      $(\"input[name='\".concat(longFieldName, \"']\")).val(ev.lng);\n    });\n    attachGeocoding($addressInputField, null, function (coordinates) {\n      $map.show(); // Remove previous marker when user updates address in address field\n\n      ctrl.removeMarker();\n      ctrl.addMarker({\n        latitude: coordinates[0],\n        longitude: coordinates[1],\n        address: $addressInput.val()\n      });\n    });\n  }\n});","map":{"version":3,"mappings":"AAAA,OAAOA,eAAP,MAA4B,oCAA5B;AACA,OAAOC,sBAAP,MAAmC,wCAAnC;AAEAC,CAAC,CAAC,YAAM;EACN,IAAMC,SAAS,GAAGD,CAAC,CAAC,uCAAD,CAAnB;EACA,IAAME,aAAa,GAAGF,CAAC,CAAC,gBAAD,CAAvB;EACA,IAAMG,kBAAkB,GAAGH,CAAC,CAAC,OAAD,EAAUE,aAAV,CAA5B;EACA,IAAME,IAAI,GAAGJ,CAAC,CAAC,cAAD,CAAd;EACA,IAAIK,YAAY,GAAG,UAAnB;EACA,IAAIC,aAAa,GAAG,WAApB;;EAEA,IAAIH,kBAAkB,CAACI,MAAnBJ,GAA4B,CAAhC,EAAmC;IACjCE,YAAY,GAAGN,sBAAsB,CAAC,UAAD,EAAaI,kBAAb,EAAiC,EAAjC,CAArCE;IACAC,aAAa,GAAGP,sBAAsB,CAAC,WAAD,EAAcI,kBAAd,EAAkC,EAAlC,CAAtCG;EACD;;EAEDF,IAAI,CAACI,IAALJ;;EAEA,IAAIH,SAAS,CAACM,MAAVN,GAAmB,CAAvB,EAA0B;IACxB,IAAMQ,WAAW,GAAG,SAAdA,WAAc,GAAM;MACxB,IAAIR,SAAS,CAAC,CAAD,CAATA,CAAaS,OAAjB,EAA0B;QACxBR,aAAa,CAACS,IAAdT;QACAC,kBAAkB,CAACS,IAAnBT,CAAwB,UAAxBA,EAAoC,KAApCA;MAFF,OAGO;QACLD,aAAa,CAACM,IAAdN;QACAC,kBAAkB,CAACS,IAAnBT,CAAwB,UAAxBA,EAAoC,IAApCA;MACD;IAPH;;IASAM,WAAW;IACXR,SAAS,CAACY,EAAVZ,CAAa,QAAbA,EAAuBQ,WAAvBR;EACD;;EAED,IAAIC,aAAa,CAACK,MAAdL,GAAuB,CAA3B,EAA8B;IAC5B,IAAID,SAAS,CAAC,CAAD,CAATA,CAAaS,OAAjB,EAA0B;MACxBN,IAAI,CAACO,IAALP;IACD;;IAED,IAAMU,IAAI,GAAGd,CAAC,CAAC,oBAAD,CAADA,CAAwBe,IAAxBf,CAA6B,gBAA7BA,CAAb;IACAc,IAAI,CAACE,eAALF,CAAqB,aAArBA,EAAoC,UAACG,EAAD,EAAQ;MAC1CjB,CAAC,uBAAgBK,YAAhB,QAADL,CAAmCkB,GAAnClB,CAAuCiB,EAAE,CAACE,GAA1CnB;MACAA,CAAC,uBAAgBM,aAAhB,QAADN,CAAoCkB,GAApClB,CAAwCiB,EAAE,CAACG,GAA3CpB;IAFF;IAKAF,eAAe,CAACK,kBAAD,EAAqB,IAArB,EAA2B,UAACkB,WAAD,EAAiB;MACzDjB,IAAI,CAACO,IAALP,GADyD,CAEzD;;MACAU,IAAI,CAACQ,YAALR;MACAA,IAAI,CAACS,SAALT,CAAe;QACbU,QAAQ,EAAEH,WAAW,CAAC,CAAD,CADR;QAEbI,SAAS,EAAEJ,WAAW,CAAC,CAAD,CAFT;QAGbK,OAAO,EAAExB,aAAa,CAACgB,GAAdhB;MAHI,CAAfY;IAJa,EAAfhB;EAUD;AAlDF,EAADE","names":["attachGeocoding","getCoordinateInputName","$","$checkbox","$addressInput","$addressInputField","$map","latFieldName","longFieldName","length","hide","toggleInput","checked","show","prop","on","ctrl","data","setEventHandler","ev","val","lat","lng","coordinates","removeMarker","addMarker","latitude","longitude","address"],"sources":["/home/agustibr/.asdf/installs/ruby/3.0.2/lib/ruby/gems/3.0.0/bundler/gems/decidim-a25b5c74f78d/decidim-proposals/app/packs/src/decidim/proposals/add_proposal.js"],"sourcesContent":["import attachGeocoding from \"src/decidim/geocoding/attach_input\"\nimport getCoordinateInputName from \"src/decidim/geocoding/coordinate_input\";\n\n$(() => {\n  const $checkbox = $(\"input:checkbox[name$='[has_address]']\");\n  const $addressInput = $(\"#address_input\");\n  const $addressInputField = $(\"input\", $addressInput);\n  const $map = $(\"#address_map\");\n  let latFieldName = \"latitude\";\n  let longFieldName = \"longitude\";\n\n  if ($addressInputField.length > 0) {\n    latFieldName = getCoordinateInputName(\"latitude\", $addressInputField, {})\n    longFieldName = getCoordinateInputName(\"longitude\", $addressInputField, {})\n  }\n\n  $map.hide();\n\n  if ($checkbox.length > 0) {\n    const toggleInput = () => {\n      if ($checkbox[0].checked) {\n        $addressInput.show();\n        $addressInputField.prop(\"disabled\", false);\n      } else {\n        $addressInput.hide();\n        $addressInputField.prop(\"disabled\", true);\n      }\n    }\n    toggleInput();\n    $checkbox.on(\"change\", toggleInput);\n  }\n\n  if ($addressInput.length > 0) {\n    if ($checkbox[0].checked) {\n      $map.show();\n    }\n\n    const ctrl = $(\"[data-decidim-map]\").data(\"map-controller\");\n    ctrl.setEventHandler(\"coordinates\", (ev) => {\n      $(`input[name='${latFieldName}']`).val(ev.lat);\n      $(`input[name='${longFieldName}']`).val(ev.lng);\n    });\n\n    attachGeocoding($addressInputField, null, (coordinates) => {\n      $map.show();\n      // Remove previous marker when user updates address in address field\n      ctrl.removeMarker();\n      ctrl.addMarker({\n        latitude: coordinates[0],\n        longitude: coordinates[1],\n        address: $addressInput.val()\n      });\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}