{"ast":null,"code":"/* eslint-disable no-invalid-this */\n\n/* eslint no-unused-vars: 0 */\n\n/* eslint id-length: [\"error\", { \"exceptions\": [\"e\"] }] */\n$(function () {\n  var selectedProposalsCount = function selectedProposalsCount() {\n    return $(\".table-list .js-check-all-proposal:checked\").length;\n  };\n\n  var selectedProposalsNotPublishedAnswerCount = function selectedProposalsNotPublishedAnswerCount() {\n    return $(\".table-list [data-published-state=false] .js-check-all-proposal:checked\").length;\n  };\n\n  var selectedProposalsCountUpdate = function selectedProposalsCountUpdate() {\n    var selectedProposals = selectedProposalsCount();\n    var selectedProposalsNotPublishedAnswer = selectedProposalsNotPublishedAnswerCount();\n\n    if (selectedProposals === 0) {\n      $(\"#js-selected-proposals-count\").text(\"\");\n    } else {\n      $(\"#js-selected-proposals-count\").text(selectedProposals);\n    }\n\n    if (selectedProposals >= 2) {\n      $('button[data-action=\"merge-proposals\"]').parent().show();\n    } else {\n      $('button[data-action=\"merge-proposals\"]').parent().hide();\n    }\n\n    if (selectedProposalsNotPublishedAnswer > 0) {\n      $('button[data-action=\"publish-answers\"]').parent().show();\n      $(\"#js-form-publish-answers-number\").text(selectedProposalsNotPublishedAnswer);\n    } else {\n      $('button[data-action=\"publish-answers\"]').parent().hide();\n    }\n  };\n\n  var showBulkActionsButton = function showBulkActionsButton() {\n    if (selectedProposalsCount() > 0) {\n      $(\"#js-bulk-actions-button\").removeClass(\"hide\");\n    }\n  };\n\n  var hideBulkActionsButton = function hideBulkActionsButton() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (selectedProposalsCount() === 0 || force === true) {\n      $(\"#js-bulk-actions-button\").addClass(\"hide\");\n      $(\"#js-bulk-actions-dropdown\").removeClass(\"is-open\");\n    }\n  };\n\n  var showOtherActionsButtons = function showOtherActionsButtons() {\n    $(\"#js-other-actions-wrapper\").removeClass(\"hide\");\n  };\n\n  var hideOtherActionsButtons = function hideOtherActionsButtons() {\n    $(\"#js-other-actions-wrapper\").addClass(\"hide\");\n  };\n\n  var hideBulkActionForms = function hideBulkActionForms() {\n    $(\".js-bulk-action-form\").addClass(\"hide\");\n  }; // Expose functions to make them avaialble in .js.erb templates\n\n\n  window.selectedProposalsCount = selectedProposalsCount;\n  window.selectedProposalsNotPublishedAnswerCount = selectedProposalsNotPublishedAnswerCount;\n  window.selectedProposalsCountUpdate = selectedProposalsCountUpdate;\n  window.showBulkActionsButton = showBulkActionsButton;\n  window.hideBulkActionsButton = hideBulkActionsButton;\n  window.showOtherActionsButtons = showOtherActionsButtons;\n  window.hideOtherActionsButtons = hideOtherActionsButtons;\n  window.hideBulkActionForms = hideBulkActionForms;\n\n  if ($(\".js-bulk-action-form\").length) {\n    hideBulkActionForms();\n    $(\"#js-bulk-actions-button\").addClass(\"hide\");\n    $(\"#js-bulk-actions-dropdown ul li button\").click(function (e) {\n      e.preventDefault();\n      var action = $(e.target).data(\"action\");\n\n      if (action) {\n        $(\"#js-form-\".concat(action)).submit(function () {\n          $(\".layout-content > .callout-wrapper\").html(\"\");\n        });\n        $(\"#js-\".concat(action, \"-actions\")).removeClass(\"hide\");\n        hideBulkActionsButton(true);\n        hideOtherActionsButtons();\n      }\n    }); // select all checkboxes\n\n    $(\".js-check-all\").change(function () {\n      $(\".js-check-all-proposal\").prop(\"checked\", $(this).prop(\"checked\"));\n\n      if ($(this).prop(\"checked\")) {\n        $(\".js-check-all-proposal\").closest(\"tr\").addClass(\"selected\");\n        showBulkActionsButton();\n      } else {\n        $(\".js-check-all-proposal\").closest(\"tr\").removeClass(\"selected\");\n        hideBulkActionsButton();\n      }\n\n      selectedProposalsCountUpdate();\n    }); // proposal checkbox change\n\n    $(\".table-list\").on(\"change\", \".js-check-all-proposal\", function (e) {\n      var proposalId = $(this).val();\n      var checked = $(this).prop(\"checked\"); // uncheck \"select all\", if one of the listed checkbox item is unchecked\n\n      if ($(this).prop(\"checked\") === false) {\n        $(\".js-check-all\").prop(\"checked\", false);\n      } // check \"select all\" if all checkbox proposals are checked\n\n\n      if ($(\".js-check-all-proposal:checked\").length === $(\".js-check-all-proposal\").length) {\n        $(\".js-check-all\").prop(\"checked\", true);\n        showBulkActionsButton();\n      }\n\n      if ($(this).prop(\"checked\")) {\n        showBulkActionsButton();\n        $(this).closest(\"tr\").addClass(\"selected\");\n      } else {\n        hideBulkActionsButton();\n        $(this).closest(\"tr\").removeClass(\"selected\");\n      }\n\n      if ($(\".js-check-all-proposal:checked\").length === 0) {\n        hideBulkActionsButton();\n      }\n\n      $(\".js-bulk-action-form\").find(\".js-proposal-id-\".concat(proposalId)).prop(\"checked\", checked);\n      selectedProposalsCountUpdate();\n    });\n    $(\".js-cancel-bulk-action\").on(\"click\", function (e) {\n      hideBulkActionForms();\n      showBulkActionsButton();\n      showOtherActionsButtons();\n    });\n  }\n});","map":{"version":3,"mappings":"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","names":["$","selectedProposalsCount","length","selectedProposalsNotPublishedAnswerCount","selectedProposalsCountUpdate","selectedProposals","selectedProposalsNotPublishedAnswer","text","parent","show","hide","showBulkActionsButton","removeClass","hideBulkActionsButton","force","addClass","showOtherActionsButtons","hideOtherActionsButtons","hideBulkActionForms","window","click","e","preventDefault","action","target","data","submit","html","change","prop","closest","on","proposalId","val","checked","find"],"sources":["/home/agustibr/.asdf/installs/ruby/3.0.2/lib/ruby/gems/3.0.0/bundler/gems/decidim-a25b5c74f78d/decidim-proposals/app/packs/src/decidim/proposals/admin/proposals.js"],"sourcesContent":["/* eslint-disable no-invalid-this */\n/* eslint no-unused-vars: 0 */\n/* eslint id-length: [\"error\", { \"exceptions\": [\"e\"] }] */\n\n$(() => {\n  const selectedProposalsCount = function() {\n    return $(\".table-list .js-check-all-proposal:checked\").length\n  }\n\n  const selectedProposalsNotPublishedAnswerCount = function() {\n    return $(\".table-list [data-published-state=false] .js-check-all-proposal:checked\").length\n  }\n\n  const selectedProposalsCountUpdate = function() {\n    const selectedProposals = selectedProposalsCount();\n    const selectedProposalsNotPublishedAnswer = selectedProposalsNotPublishedAnswerCount();\n    if (selectedProposals === 0) {\n      $(\"#js-selected-proposals-count\").text(\"\")\n    } else {\n      $(\"#js-selected-proposals-count\").text(selectedProposals);\n    }\n\n    if (selectedProposals >= 2) {\n      $('button[data-action=\"merge-proposals\"]').parent().show();\n    } else {\n      $('button[data-action=\"merge-proposals\"]').parent().hide();\n    }\n\n    if (selectedProposalsNotPublishedAnswer > 0) {\n      $('button[data-action=\"publish-answers\"]').parent().show();\n      $(\"#js-form-publish-answers-number\").text(selectedProposalsNotPublishedAnswer);\n    } else {\n      $('button[data-action=\"publish-answers\"]').parent().hide();\n    }\n  }\n\n  const showBulkActionsButton = function() {\n    if (selectedProposalsCount() > 0) {\n      $(\"#js-bulk-actions-button\").removeClass(\"hide\");\n    }\n  }\n\n  const hideBulkActionsButton = function(force = false) {\n    if (selectedProposalsCount() === 0 || force === true) {\n      $(\"#js-bulk-actions-button\").addClass(\"hide\");\n      $(\"#js-bulk-actions-dropdown\").removeClass(\"is-open\");\n    }\n  }\n\n  const showOtherActionsButtons = function() {\n    $(\"#js-other-actions-wrapper\").removeClass(\"hide\");\n  }\n\n  const hideOtherActionsButtons = function() {\n    $(\"#js-other-actions-wrapper\").addClass(\"hide\");\n  }\n\n  const hideBulkActionForms = function() {\n    $(\".js-bulk-action-form\").addClass(\"hide\");\n  }\n\n  // Expose functions to make them avaialble in .js.erb templates\n  window.selectedProposalsCount = selectedProposalsCount;\n  window.selectedProposalsNotPublishedAnswerCount = selectedProposalsNotPublishedAnswerCount;\n  window.selectedProposalsCountUpdate = selectedProposalsCountUpdate;\n  window.showBulkActionsButton = showBulkActionsButton;\n  window.hideBulkActionsButton = hideBulkActionsButton;\n  window.showOtherActionsButtons = showOtherActionsButtons;\n  window.hideOtherActionsButtons = hideOtherActionsButtons;\n  window.hideBulkActionForms = hideBulkActionForms;\n\n  if ($(\".js-bulk-action-form\").length) {\n    hideBulkActionForms();\n    $(\"#js-bulk-actions-button\").addClass(\"hide\");\n\n    $(\"#js-bulk-actions-dropdown ul li button\").click(function(e) {\n      e.preventDefault();\n      let action = $(e.target).data(\"action\");\n\n      if (action) {\n        $(`#js-form-${action}`).submit(function() {\n          $(\".layout-content > .callout-wrapper\").html(\"\");\n        })\n\n        $(`#js-${action}-actions`).removeClass(\"hide\");\n        hideBulkActionsButton(true);\n        hideOtherActionsButtons();\n      }\n    })\n\n    // select all checkboxes\n    $(\".js-check-all\").change(function() {\n      $(\".js-check-all-proposal\").prop(\"checked\", $(this).prop(\"checked\"));\n\n      if ($(this).prop(\"checked\")) {\n        $(\".js-check-all-proposal\").closest(\"tr\").addClass(\"selected\");\n        showBulkActionsButton();\n      } else {\n        $(\".js-check-all-proposal\").closest(\"tr\").removeClass(\"selected\");\n        hideBulkActionsButton();\n      }\n\n      selectedProposalsCountUpdate();\n    });\n\n    // proposal checkbox change\n    $(\".table-list\").on(\"change\", \".js-check-all-proposal\", function (e) {\n      let proposalId = $(this).val()\n      let checked = $(this).prop(\"checked\")\n\n      // uncheck \"select all\", if one of the listed checkbox item is unchecked\n      if ($(this).prop(\"checked\") === false) {\n        $(\".js-check-all\").prop(\"checked\", false);\n      }\n      // check \"select all\" if all checkbox proposals are checked\n      if ($(\".js-check-all-proposal:checked\").length === $(\".js-check-all-proposal\").length) {\n        $(\".js-check-all\").prop(\"checked\", true);\n        showBulkActionsButton();\n      }\n\n      if ($(this).prop(\"checked\")) {\n        showBulkActionsButton();\n        $(this).closest(\"tr\").addClass(\"selected\");\n      } else {\n        hideBulkActionsButton();\n        $(this).closest(\"tr\").removeClass(\"selected\");\n      }\n\n      if ($(\".js-check-all-proposal:checked\").length === 0) {\n        hideBulkActionsButton();\n      }\n\n      $(\".js-bulk-action-form\").find(`.js-proposal-id-${proposalId}`).prop(\"checked\", checked);\n      selectedProposalsCountUpdate();\n    });\n\n    $(\".js-cancel-bulk-action\").on(\"click\", function (e) {\n      hideBulkActionForms()\n      showBulkActionsButton();\n      showOtherActionsButtons();\n    });\n  }\n});\n"]},"metadata":{},"sourceType":"module"}