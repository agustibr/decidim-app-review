{"ast":null,"code":"function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nvar DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nvar MESSAGES = DEFAULT_MESSAGES;\n\nvar FormValidator = /*#__PURE__*/function () {\n  function FormValidator(form) {\n    var _this = this;\n\n    _classCallCheck(this, FormValidator);\n\n    this.$form = form;\n    this.$form.on(\"form-error.decidim\", function () {\n      _this.handleError();\n    });\n  }\n\n  _createClass(FormValidator, [{\n    key: \"handleError\",\n    value: function handleError() {\n      this.announceFormError();\n      $(\".is-invalid-input:first\", this.$form).focus();\n    }\n    /**\n     * This announces immediately to the screen reader that there are errors on\n     * the form that need to be fixed. Does not work on all screen readers but\n     * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n     * combinations.\n     *\n     * @returns {undefined}\n     */\n\n  }, {\n    key: \"announceFormError\",\n    value: function announceFormError() {\n      var $announce = $(\".sr-announce\", this.$form);\n\n      if ($announce.length > 0) {\n        $announce.remove();\n      }\n\n      $announce = $(\"<div />\");\n      $announce.attr(\"class\", \"sr-announce show-for-sr\");\n      $announce.attr(\"aria-live\", \"assertive\");\n      this.$form.prepend($announce);\n      setTimeout(function () {\n        $announce.text(MESSAGES.correctErrors);\n      }, 100);\n    }\n  }], [{\n    key: \"configureMessages\",\n    value: function configureMessages(messages) {\n      MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n    }\n  }]);\n\n  return FormValidator;\n}();\n\nexport { FormValidator as default };\n$(function () {\n  $(\"form\").each(function (_i, el) {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function (_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  });\n});","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,gBAAgB,GAAG;EACvBC,aAAa,EAAE;AADQ,CAAzB;AAGA,IAAIC,QAAQ,GAAGF,gBAAf;;IAEqBG,a;EAKnB,uBAAYC,IAAZ,EAAkB;IAAA;;IAAAC;;IAChB,KAAKC,KAAL,GAAaF,IAAb;IAEA,KAAKE,KAAL,CAAWC,EAAX,CAAc,oBAAd,EAAoC,YAAM;MACxCC,KAAI,CAACC,WAAL;IADF;EAGD;;;;WAED,uBAAc;MACZ,KAAKC,iBAAL;MAEAC,CAAC,CAAC,yBAAD,EAA4B,KAAKL,KAAjC,CAADK,CAAyCC,KAAzCD;IACD;IAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;;WACE,6BAAoB;MAClB,IAAIE,SAAS,GAAGF,CAAC,CAAC,cAAD,EAAiB,KAAKL,KAAtB,CAAjB;;MACA,IAAIO,SAAS,CAACC,MAAVD,GAAmB,CAAvB,EAA0B;QACxBA,SAAS,CAACE,MAAVF;MACD;;MACDA,SAAS,GAAGF,CAAC,CAAC,SAAD,CAAbE;MACAA,SAAS,CAACG,IAAVH,CAAe,OAAfA,EAAwB,yBAAxBA;MACAA,SAAS,CAACG,IAAVH,CAAe,WAAfA,EAA4B,WAA5BA;MACA,KAAKP,KAAL,CAAWW,OAAX,CAAmBJ,SAAnB;MAEAK,UAAU,CAAC,YAAM;QACfL,SAAS,CAACM,IAAVN,CAAeX,QAAQ,CAACD,aAAxBY;MADQ,GAEP,GAFO,CAAVK;IAGD;;;WAvCD,2BAAyBE,QAAzB,EAAmC;MACjClB,QAAQ,GAAGS,CAAC,CAACU,MAAFV,CAASX,gBAATW,EAA2BS,QAA3BT,CAAXT;IACD;;;;;;SAHkBC,a;AA2CrBQ,CAAC,CAAC,YAAM;EACNA,CAAC,CAAC,MAAD,CAADA,CAAUW,IAAVX,CAAe,UAACY,EAAD,EAAKC,EAAL,EAAY;IACzBb,CAAC,CAACa,EAAD,CAADb,CAAMc,IAANd,CAAW,gBAAXA,EAA6B,IAAIR,aAAJ,CAAkBQ,CAAC,CAACa,EAAD,CAAnB,CAA7Bb;EADF;EAGAA,CAAC,CAACe,QAAD,CAADf,CAAYJ,EAAZI,CAAe,sBAAfA,EAAuC,UAASgB,GAAT,EAAcvB,IAAd,EAAoB;IACzDA,IAAI,CAACwB,OAALxB,CAAa,oBAAbA;EADF;AAJD,EAADO","names":["DEFAULT_MESSAGES","correctErrors","MESSAGES","FormValidator","form","_classCallCheck","$form","on","_this","handleError","announceFormError","$","focus","$announce","length","remove","attr","prepend","setTimeout","text","messages","extend","each","_i","el","data","document","_ev","trigger"],"sources":["/home/agustibr/.asdf/installs/ruby/3.0.2/lib/ruby/gems/3.0.0/bundler/gems/decidim-a25b5c74f78d/decidim-core/app/packs/src/decidim/form_validator.js"],"sourcesContent":["const DEFAULT_MESSAGES = {\n  correctErrors: \"There are errors on the form, please correct them.\"\n};\nlet MESSAGES = DEFAULT_MESSAGES;\n\nexport default class FormValidator {\n  static configureMessages(messages) {\n    MESSAGES = $.extend(DEFAULT_MESSAGES, messages);\n  }\n\n  constructor(form) {\n    this.$form = form;\n\n    this.$form.on(\"form-error.decidim\", () => {\n      this.handleError();\n    });\n  }\n\n  handleError() {\n    this.announceFormError();\n\n    $(\".is-invalid-input:first\", this.$form).focus();\n  }\n\n  /**\n   * This announces immediately to the screen reader that there are errors on\n   * the form that need to be fixed. Does not work on all screen readers but\n   * works e.g. in Windows+Firefox+NVDA and macOS+Safari+VoiceOver\n   * combinations.\n   *\n   * @returns {undefined}\n   */\n  announceFormError() {\n    let $announce = $(\".sr-announce\", this.$form);\n    if ($announce.length > 0) {\n      $announce.remove();\n    }\n    $announce = $(\"<div />\");\n    $announce.attr(\"class\", \"sr-announce show-for-sr\");\n    $announce.attr(\"aria-live\", \"assertive\");\n    this.$form.prepend($announce);\n\n    setTimeout(() => {\n      $announce.text(MESSAGES.correctErrors);\n    }, 100);\n  }\n}\n\n$(() => {\n  $(\"form\").each((_i, el) => {\n    $(el).data(\"form-validator\", new FormValidator($(el)));\n  });\n  $(document).on(\"forminvalid.zf.abide\", function(_ev, form) {\n    form.trigger(\"form-error.decidim\");\n  })\n});\n"]},"metadata":{},"sourceType":"module"}